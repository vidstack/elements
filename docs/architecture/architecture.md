# Architecture

## Player

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgK2lkZW50aWZlcjogc3ltYm9sXG4gICAgK3NyYzogU291cmNlW11cbiAgICArcGF1c2VkOiBib29sZWFuXG4gICAgK3ZvbHVtZTogbnVtYmVyXG4gICAgLi4uXG4gICAgK2F1dG9Bc3BlY3RSYXRpbzogYm9vbGVhblxuICAgICthdXRvRmV0Y2hQb3N0ZXI6IGJvb2xlYW5cbiAgICAraGVhcnRiZWF0SW50ZXJ2YWw6IG51bWJlclxuICAgICtjdXJyZW50UHJvdmlkZXI_OiBNZWRpYVByb3ZpZGVyfmFueX5cbiAgICAjcGxheWVyU3RvcmU6IFBsYXllclN0b3JlXG5cbiAgICAjaGFuZGxlTWVkaWFDaGFuZ2UoKSB2b2lkXG4gICAgI2hhbmRsZVByb3ZpZGVyQ2hhbmdlKCkgdm9pZFxuICAgICtwbGF5KCkgUHJvbWlzZX52b2lkfiBcbiAgICArcGF1c2UoKSBQcm9taXNlfnZvaWR-IFxuICAgICtnZXRDYXB0dXJlU3RyZWFtKCkgTWVkaWFTdHJlYW18dW5kZWZpbmVkXG4gICAgK2dldEN1cnJlbnRQbGF5ZXJTdGF0ZSgpIFBsYXllclN0YXRlXG59XG5cblBsYXllciAtLSBWaWV3VHlwZVxuUGxheWVyIC0tIE1lZGlhVHlwZVxuUGxheWVyIFwiMVwiIC0tKiBcIjAuLipcIiBNZWRpYVByb3ZpZGVyOiBjb21wb3NpdGlvblxuXG5jbGFzcyBQbGF5ZXJDb250ZXh0XG5QbGF5ZXIgLS0-IFBsYXllckNvbnRleHQ6IGhhc1xuXG5jbGFzcyBQbGF5ZXJTdGF0ZSB7XG4gICAgPDxpbnRlcmZhY2U-PlxuICAgIHNyYzogU291cmNlW11cbiAgICBjdXJyZW50VGltZTogbnVtYmVyXG4gICAgdm9sdW1lOiBudW1iZXJcbiAgICB0cmltPzogTWVkaWFUcmltXG4gICAgaW5WaWV3cG9ydDogYm9vbGVhblxuICAgIC4uLlxufVxuXG5QbGF5ZXIgLS0-IFBsYXllclN0YXRlOiBpbXBsZW1lbnRzXG5QbGF5ZXJDb250ZXh0IC0tPiBQbGF5ZXJTdGF0ZTogaW1wbGVtZW50c1xuXG5jbGFzcyBNZWRpYVRyaW0ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBzdGFydFRpbWU6IG51bWJlclxuICAgIGVuZFRpbWU6IG51bWJlclxuICAgIGR1cmF0aW9uOiBudW1iZXJcbn1cblxuUGxheWVyU3RhdGUgLS0gTWVkaWFUcmltIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgK2lkZW50aWZlcjogc3ltYm9sXG4gICAgK3NyYzogU291cmNlW11cbiAgICArcGF1c2VkOiBib29sZWFuXG4gICAgK3ZvbHVtZTogbnVtYmVyXG4gICAgLi4uXG4gICAgK2F1dG9Bc3BlY3RSYXRpbzogYm9vbGVhblxuICAgICthdXRvRmV0Y2hQb3N0ZXI6IGJvb2xlYW5cbiAgICAraGVhcnRiZWF0SW50ZXJ2YWw6IG51bWJlclxuICAgICtjdXJyZW50UHJvdmlkZXI_OiBNZWRpYVByb3ZpZGVyfmFueX5cbiAgICAjcGxheWVyU3RvcmU6IFBsYXllclN0b3JlXG5cbiAgICAjaGFuZGxlTWVkaWFDaGFuZ2UoKSB2b2lkXG4gICAgI2hhbmRsZVByb3ZpZGVyQ2hhbmdlKCkgdm9pZFxuICAgICtwbGF5KCkgUHJvbWlzZX52b2lkfiBcbiAgICArcGF1c2UoKSBQcm9taXNlfnZvaWR-IFxuICAgICtnZXRDYXB0dXJlU3RyZWFtKCkgTWVkaWFTdHJlYW18dW5kZWZpbmVkXG4gICAgK2dldEN1cnJlbnRQbGF5ZXJTdGF0ZSgpIFBsYXllclN0YXRlXG59XG5cblBsYXllciAtLSBWaWV3VHlwZVxuUGxheWVyIC0tIE1lZGlhVHlwZVxuUGxheWVyIFwiMVwiIC0tKiBcIjAuLipcIiBNZWRpYVByb3ZpZGVyOiBjb21wb3NpdGlvblxuXG5jbGFzcyBQbGF5ZXJDb250ZXh0XG5QbGF5ZXIgLS0-IFBsYXllckNvbnRleHQ6IGhhc1xuXG5jbGFzcyBQbGF5ZXJTdGF0ZSB7XG4gICAgPDxpbnRlcmZhY2U-PlxuICAgIHNyYzogU291cmNlW11cbiAgICBjdXJyZW50VGltZTogbnVtYmVyXG4gICAgdm9sdW1lOiBudW1iZXJcbiAgICB0cmltPzogTWVkaWFUcmltXG4gICAgaW5WaWV3cG9ydDogYm9vbGVhblxuICAgIC4uLlxufVxuXG5QbGF5ZXIgLS0-IFBsYXllclN0YXRlOiBpbXBsZW1lbnRzXG5QbGF5ZXJDb250ZXh0IC0tPiBQbGF5ZXJTdGF0ZTogaW1wbGVtZW50c1xuXG5jbGFzcyBNZWRpYVRyaW0ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBzdGFydFRpbWU6IG51bWJlclxuICAgIGVuZFRpbWU6IG51bWJlclxuICAgIGR1cmF0aW9uOiBudW1iZXJcbn1cblxuUGxheWVyU3RhdGUgLS0gTWVkaWFUcmltIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)

## Update Flow

The following uses setting the `paused` property to `false` as an example to show how update flows
differ between Provider, UI and Consumer (direct reference to `player` element).

[![](https://mermaid.ink/img/eyJjb2RlIjoic2VxdWVuY2VEaWFncmFtXG4gICAgYWx0IFByb3ZpZGVyIFVwZGF0ZVxuICAgICAgICByZWN0IHJnYigwLCAyNTUsIDAsIC4xKVxuICAgICAgICBQcm92aWRlciAtLT4-IFBsYXllcjogUHJvdmlkZXJQbGF5IEV2ZW50XG4gICAgICAgIFBsYXllciAtPj4gUGxheWVyQ29udGV4dDogVXBkYXRlXG4gICAgICAgIFBsYXllckNvbnRleHQgLS0-PiBVSTogQ29udGV4dFVwZGF0ZVxuICAgICAgICBlbmRcbiAgICBlbHNlIFVJIFVwZGF0ZVxuICAgICAgICByZWN0IHJnYmEoMCwgMCwgMjU1LCAuMSlcbiAgICAgICAgVUkgLS0-PiBQbGF5ZXI6IFVJUGxheSBFdmVudFxuICAgICAgICBQbGF5ZXIgLT4-IFByb3ZpZGVyOiBzZXRQYXVzZWQoZmFsc2UpXG4gICAgICAgIFByb3ZpZGVyIC0tPj4gUGxheWVyOiBQcm92aWRlclBsYXkgRXZlbnRcbiAgICAgICAgUGxheWVyIC0-PiBQbGF5ZXJDb250ZXh0OiBVcGRhdGVcbiAgICAgICAgUGxheWVyQ29udGV4dCAtLT4-IFVJOiBDb250ZXh0VXBkYXRlXG4gICAgICAgIGVuZFxuICAgIGVsc2UgQ29uc3VtZXIgVXBkYXRlXG4gICAgICAgIHJlY3QgcmdiYSgyNTUsIDAsIDAsIC4xKVxuICAgICAgICBDb25zdW1lciAtPj4gUGxheWVyOiBwbGF5ZXIucGF1c2VkID0gZmFsc2VcbiAgICAgICAgUGxheWVyIC0-PiBQbGF5ZXI6IHBhdXNlZCBzZXR0ZXIgdHJpZ2dlcmVkXG4gICAgICAgIFBsYXllciAtPj4gUHJvdmlkZXI6IHNldFBhdXNlZChmYWxzZSlcbiAgICAgICAgUHJvdmlkZXIgLS0-PiBQbGF5ZXI6IFByb3ZpZGVyUGxheSBFdmVudFxuICAgICAgICBQbGF5ZXIgLT4-IFBsYXllckNvbnRleHQ6IFVwZGF0ZVxuICAgICAgICBQbGF5ZXJDb250ZXh0IC0tPj4gVUk6IENvbnRleHRVcGRhdGVcbiAgICAgICAgZW5kXG4gICAgZW5kIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoic2VxdWVuY2VEaWFncmFtXG4gICAgYWx0IFByb3ZpZGVyIFVwZGF0ZVxuICAgICAgICByZWN0IHJnYigwLCAyNTUsIDAsIC4xKVxuICAgICAgICBQcm92aWRlciAtLT4-IFBsYXllcjogUHJvdmlkZXJQbGF5IEV2ZW50XG4gICAgICAgIFBsYXllciAtPj4gUGxheWVyQ29udGV4dDogVXBkYXRlXG4gICAgICAgIFBsYXllckNvbnRleHQgLS0-PiBVSTogQ29udGV4dFVwZGF0ZVxuICAgICAgICBlbmRcbiAgICBlbHNlIFVJIFVwZGF0ZVxuICAgICAgICByZWN0IHJnYmEoMCwgMCwgMjU1LCAuMSlcbiAgICAgICAgVUkgLS0-PiBQbGF5ZXI6IFVJUGxheSBFdmVudFxuICAgICAgICBQbGF5ZXIgLT4-IFByb3ZpZGVyOiBzZXRQYXVzZWQoZmFsc2UpXG4gICAgICAgIFByb3ZpZGVyIC0tPj4gUGxheWVyOiBQcm92aWRlclBsYXkgRXZlbnRcbiAgICAgICAgUGxheWVyIC0-PiBQbGF5ZXJDb250ZXh0OiBVcGRhdGVcbiAgICAgICAgUGxheWVyQ29udGV4dCAtLT4-IFVJOiBDb250ZXh0VXBkYXRlXG4gICAgICAgIGVuZFxuICAgIGVsc2UgQ29uc3VtZXIgVXBkYXRlXG4gICAgICAgIHJlY3QgcmdiYSgyNTUsIDAsIDAsIC4xKVxuICAgICAgICBDb25zdW1lciAtPj4gUGxheWVyOiBwbGF5ZXIucGF1c2VkID0gZmFsc2VcbiAgICAgICAgUGxheWVyIC0-PiBQbGF5ZXI6IHBhdXNlZCBzZXR0ZXIgdHJpZ2dlcmVkXG4gICAgICAgIFBsYXllciAtPj4gUHJvdmlkZXI6IHNldFBhdXNlZChmYWxzZSlcbiAgICAgICAgUHJvdmlkZXIgLS0-PiBQbGF5ZXI6IFByb3ZpZGVyUGxheSBFdmVudFxuICAgICAgICBQbGF5ZXIgLT4-IFBsYXllckNvbnRleHQ6IFVwZGF0ZVxuICAgICAgICBQbGF5ZXJDb250ZXh0IC0tPj4gVUk6IENvbnRleHRVcGRhdGVcbiAgICAgICAgZW5kXG4gICAgZW5kIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)

## Providers

The player will manage as much functionality as possible to avoid colliding with providers and for
consistency across them. This includes features like `autoplay`, `loop` and even `render()`. By enabling
the player to control when a provider is rendered we can open new features such as:

- Multiple providers can be passed in at the same time and cached. Providers can also potentially
  be loaded and prepared in the background.
- [Boot strategies](#boot-strategy) become possible which determine how/when a provider is loaded.
  Whether it is lazily loaded, when the poster is clicked, immediately or based on some custom logic.
- The player can select which source/s and provider to render based on a [media load strategy](#media-load-strategy).

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFlvdVR1YmVcbmNsYXNzIFZpbWVvXG5jbGFzcyBEYWlseW1vdGlvblxuY2xhc3MgRW1iZWRcblxuWW91VHViZSAtLSBFbWJlZDogdXNlc1xuVmltZW8gLS0gRW1iZWQ6IHVzZXNcbkRhaWx5bW90aW9uIC0tIEVtYmVkOiB1c2VzXG5cbmNsYXNzIEVtYmVkZWRNZWRpYVByb3ZpZGVyflBhcmFtc1R5cGUsTWVzc2FnZVR5cGV-IHtcbiAgICA8PGFic3RyYWN0Pj5cbiAgICAjZW1iZWQ_OiBIVE1MVmRzRW1iZWRFbGVtZW50XG4gICAgI2VtYmVkU3JjPzogc3RyaW5nXG5cbiAgICBnZXRNZWRpYVRpdGxlKCkqIHN0cmluZ3x1bmRlZmluZWRcbiAgICBnZXRPcmlnaW4oKSogc3RyaW5nXG4gICAgYnVpbGRQYXJhbXMoKSogUGFyYW1zVHlwZVxuICAgIGdldERlY29kZXIoKSogRGVjb2RlclxuICAgIGdldFByZWNvbm5lY3Rpb25zKCkqXG4gICAgb25FbWJlZExvYWRlZCgpKlxuICAgIG9uRW1iZWRNZXNzYWdlKEN1c3RvbUV2ZW50fk1lc3NhZ2VUeXBlfiBldmVudCkqXG4gICAgb25FbWJlZFNyY0NoYW5nZSgpKlxufVxuXG5FbWJlZGVkTWVkaWFQcm92aWRlciA8fC0tIFlvdVR1YmU6IGV4dGVuZHNcbkVtYmVkZWRNZWRpYVByb3ZpZGVyIDx8LS0gVmltZW86IGV4dGVuZHNcbkVtYmVkZWRNZWRpYVByb3ZpZGVyIDx8LS0gRGFpbHltb3Rpb246IGV4dGVuZHNcblxuY2xhc3MgVmlkZW9cbmNsYXNzIEF1ZGlvXG5jbGFzcyBGaWxlXG5jbGFzcyBITFNcbmNsYXNzIERBU0hcblxuY2xhc3MgTWVkaWFGaWxlUHJvdmlkZXIge1xuICAgICNtZWRpYUVsPzogSFRNTE1lZGlhRWxlbWVudFxuICAgICtjcm9zc09yaWdpbj86IHRydWUgfCBhbm9ueW1vdXMgfCBjcmVkZW50aWFsc1xuICAgICtwcmVsb2FkPzogdHJ1ZSB8IG5vbmUgfCBtZXRhZGF0YSB8IGF1dG9cbiAgICArcG9zdGVyPzogc3RyaW5nXG4gICAgK2NvbnRyb2xzTGlzdD86IHN0cmluZ1xuICAgICthdXRvUGlQPzogc3RyaW5nXG4gICAgK2Rpc2FibGVQaVA_OiBib29sZWFuXG4gICAgK2Rpc2FibGVSZW1vdGVQbGF5YmFjaz86IGJvb2xlYW5cbn1cblxuRmlsZSA8fC0tIEF1ZGlvOiBleHRlbmRzXG5GaWxlIDx8LS0gVmlkZW86IGV4dGVuZHNcbk1lZGlhRmlsZVByb3ZpZGVyIDx8LS0gRmlsZTogZXh0ZW5kc1xuTWVkaWFGaWxlUHJvdmlkZXIgPHwtLSBITFM6IGV4dGVuZHNcbk1lZGlhRmlsZVByb3ZpZGVyIDx8LS0gREFTSDogZXh0ZW5kc1xuXG5jbGFzcyBNZWRpYVByb3ZpZGVyfkludGVybmFsUGxheWVyVHlwZX4ge1xuICAgIDw8YWJzdHJhY3Q-PlxuICAgICNjb250cm9sczogYm9vbGVhblxuICAgICNsYW5ndWFnZTogc3RyaW5nXG4gICAgI3BsYXlzaW5saW5lOmJvb2xlYW5cblxuICAgIHBsYXkoKSogUHJvbWlzZX52b2lkflxuICAgIHBhdXNlKCkqIFByb21pc2V-dm9pZH5cbiAgICBjYW5QbGF5KHR5cGU6IHN0cmluZykqIHZvaWRcbiAgICBsb2FkTWVkaWEoc3JjOiBTb3VyY2VbXSkqIHZvaWRcbiAgICBnZXRJbnRlcm5hbFBsYXllcigpKiBJbnRlcm5hbFBsYXllclR5cGVcbiAgICBnZXRDdXJyZW50Vmlld1R5cGUoKSogVmlld1R5cGVcbiAgICBnZXRDdXJyZW50TWVkaWFUeXBlKCkqIE1lZGlhVHlwZVxuICAgIHNldEN1cnJlbnRUaW1lKHRpbWU6IG51bWJlcikqIHZvaWRcbiAgICBzZXRNdXRlZChtdXRlZDogYm9vbGVhbikqIHZvaWRcbiAgICBzZXRWb2x1bWUodm9sdW1lOiBudW1iZXIpKiB2b2lkXG4gICAgY2FuU2V0UGxheWJhY2tSYXRlKCkqIGJvb2xlYW5cbiAgICBzZXRQbGF5YmFja1JhdGUocmF0ZTogbnVtYmVyKSogdm9pZFxuICAgIGNhblNldFBsYXliYWNrUXVhbGl0eSgpKiBib29sZWFuXG4gICAgc2V0UGxheWJhY2tRdWFsaXR5KHF1YWxpdHk6IHN0cmluZykqIHZvaWRcbiAgICBjYW5TZXRGdWxsc2NyZWVuKCkqIGJvb2xlYW5cbiAgICBlbnRlckZ1bGxzY3JlZW4ob3B0aW9ucz86IEZ1bGxzY3JlZW5PcHRpb25zKSogUHJvbWlzZX52b2lkflxuICAgIGV4aXRGdWxsc2NyZWVuKCkqIFByb21pc2V-dm9pZH5cbiAgICBjYW5TZXRQaVAoKSogYm9vbGVhblxuICAgIGVudGVyUGlQKCkqIFByb21pc2V-dm9pZH5cbiAgICBleGl0UGlQKCkqIFByb21pc2V-dm9pZH5cbiAgICBzZXRDdXJyZW50VGV4dFRyYWNrKHRyYWNrSWQ6IG51bWJlcikqIHZvaWRcbiAgICBzZXRUZXh0VHJhY2tWaXNpYmlsaXR5KGlzVmlzaWJsZTogYm9vbGVhbikqIHZvaWRcbiAgICBnZXRNZWRpYVRyaW1taW5nKCkqIE1lZGlhVHJpbXx1bmRlZmluZWRcbiAgICBmZXRjaFJlY29tbWVuZGVkQXNwZWN0UmF0aW8oKSogUHJvbWlzZX5zdHJpbmd-XG4gICAgZmV0Y2hDdXJyZW50UG9zdGVyKCkqIFByb21pc2V-c3RyaW5nflxuICAgIGZldGNoQ3VycmVudE1lZGlhVGl0bGUoKSogUHJvbWlzZX5zdHJpbmd-XG4gICAgZmV0Y2hDdXJyZW50TWVkaWFEdXJhdGlvbigpKiBQcm9taXNlfm51bWJlcn5cbiAgICByZW5kZXJQbGF5ZXIoKSogSFRNTFRlbXBsYXRlU3RyaW5nXG4gICAgZGVzdHJveSgpKiB2b2lkXG4gICAgLXJlbmRlcigpIHZvaWRcbn1cblxuTWVkaWFQcm92aWRlciA8fC0tIE1lZGlhRmlsZVByb3ZpZGVyXG5NZWRpYVByb3ZpZGVyIDx8LS0gRW1iZWRlZE1lZGlhUHJvdmlkZXJcblxuY2xhc3MgTWVkaWFUeXBlIHtcbiAgICA8PGVudW1lcmF0aW9uPj5cbiAgICBBVURJT1xuICAgIFZJREVPXG59XG5cbmNsYXNzIFZpZXdUeXBlIHtcbiAgICA8PGVudW1lcmF0aW9uPj5cbiAgICBBVURJT1xuICAgIFZJREVPXG59XG5cbk1lZGlhVHlwZSAtLSBNZWRpYVByb3ZpZGVyXG5WaWV3VHlwZSAtLSBNZWRpYVByb3ZpZGVyXG5cbmNsYXNzIFBsYXllclxuXG5QbGF5ZXIgLS0gTWVkaWFUeXBlXG5QbGF5ZXIgLS0gVmlld1R5cGVcblBsYXllciBcIjFcIiAtLSogXCIwLi4qXCIgTWVkaWFQcm92aWRlcjogY29tcG9zaXRpb24iLCJtZXJtYWlkIjp7fSwidXBkYXRlRWRpdG9yIjpmYWxzZX0)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFlvdVR1YmVcbmNsYXNzIFZpbWVvXG5jbGFzcyBEYWlseW1vdGlvblxuY2xhc3MgRW1iZWRcblxuWW91VHViZSAtLSBFbWJlZDogdXNlc1xuVmltZW8gLS0gRW1iZWQ6IHVzZXNcbkRhaWx5bW90aW9uIC0tIEVtYmVkOiB1c2VzXG5cbmNsYXNzIEVtYmVkZWRNZWRpYVByb3ZpZGVyflBhcmFtc1R5cGUsTWVzc2FnZVR5cGV-IHtcbiAgICA8PGFic3RyYWN0Pj5cbiAgICAjZW1iZWQ_OiBIVE1MVmRzRW1iZWRFbGVtZW50XG4gICAgI2VtYmVkU3JjPzogc3RyaW5nXG5cbiAgICBnZXRNZWRpYVRpdGxlKCkqIHN0cmluZ3x1bmRlZmluZWRcbiAgICBnZXRPcmlnaW4oKSogc3RyaW5nXG4gICAgYnVpbGRQYXJhbXMoKSogUGFyYW1zVHlwZVxuICAgIGdldERlY29kZXIoKSogRGVjb2RlclxuICAgIGdldFByZWNvbm5lY3Rpb25zKCkqXG4gICAgb25FbWJlZExvYWRlZCgpKlxuICAgIG9uRW1iZWRNZXNzYWdlKEN1c3RvbUV2ZW50fk1lc3NhZ2VUeXBlfiBldmVudCkqXG4gICAgb25FbWJlZFNyY0NoYW5nZSgpKlxufVxuXG5FbWJlZGVkTWVkaWFQcm92aWRlciA8fC0tIFlvdVR1YmU6IGV4dGVuZHNcbkVtYmVkZWRNZWRpYVByb3ZpZGVyIDx8LS0gVmltZW86IGV4dGVuZHNcbkVtYmVkZWRNZWRpYVByb3ZpZGVyIDx8LS0gRGFpbHltb3Rpb246IGV4dGVuZHNcblxuY2xhc3MgVmlkZW9cbmNsYXNzIEF1ZGlvXG5jbGFzcyBGaWxlXG5jbGFzcyBITFNcbmNsYXNzIERBU0hcblxuY2xhc3MgTWVkaWFGaWxlUHJvdmlkZXIge1xuICAgICNtZWRpYUVsPzogSFRNTE1lZGlhRWxlbWVudFxuICAgICtjcm9zc09yaWdpbj86IHRydWUgfCBhbm9ueW1vdXMgfCBjcmVkZW50aWFsc1xuICAgICtwcmVsb2FkPzogdHJ1ZSB8IG5vbmUgfCBtZXRhZGF0YSB8IGF1dG9cbiAgICArcG9zdGVyPzogc3RyaW5nXG4gICAgK2NvbnRyb2xzTGlzdD86IHN0cmluZ1xuICAgICthdXRvUGlQPzogc3RyaW5nXG4gICAgK2Rpc2FibGVQaVA_OiBib29sZWFuXG4gICAgK2Rpc2FibGVSZW1vdGVQbGF5YmFjaz86IGJvb2xlYW5cbn1cblxuRmlsZSA8fC0tIEF1ZGlvOiBleHRlbmRzXG5GaWxlIDx8LS0gVmlkZW86IGV4dGVuZHNcbk1lZGlhRmlsZVByb3ZpZGVyIDx8LS0gRmlsZTogZXh0ZW5kc1xuTWVkaWFGaWxlUHJvdmlkZXIgPHwtLSBITFM6IGV4dGVuZHNcbk1lZGlhRmlsZVByb3ZpZGVyIDx8LS0gREFTSDogZXh0ZW5kc1xuXG5jbGFzcyBNZWRpYVByb3ZpZGVyfkludGVybmFsUGxheWVyVHlwZX4ge1xuICAgIDw8YWJzdHJhY3Q-PlxuICAgICNjb250cm9sczogYm9vbGVhblxuICAgICNsYW5ndWFnZTogc3RyaW5nXG4gICAgI3BsYXlzaW5saW5lOmJvb2xlYW5cblxuICAgIHBsYXkoKSogUHJvbWlzZX52b2lkflxuICAgIHBhdXNlKCkqIFByb21pc2V-dm9pZH5cbiAgICBjYW5QbGF5KHR5cGU6IHN0cmluZykqIHZvaWRcbiAgICBsb2FkTWVkaWEoc3JjOiBTb3VyY2VbXSkqIHZvaWRcbiAgICBnZXRJbnRlcm5hbFBsYXllcigpKiBJbnRlcm5hbFBsYXllclR5cGVcbiAgICBnZXRDdXJyZW50Vmlld1R5cGUoKSogVmlld1R5cGVcbiAgICBnZXRDdXJyZW50TWVkaWFUeXBlKCkqIE1lZGlhVHlwZVxuICAgIHNldEN1cnJlbnRUaW1lKHRpbWU6IG51bWJlcikqIHZvaWRcbiAgICBzZXRNdXRlZChtdXRlZDogYm9vbGVhbikqIHZvaWRcbiAgICBzZXRWb2x1bWUodm9sdW1lOiBudW1iZXIpKiB2b2lkXG4gICAgY2FuU2V0UGxheWJhY2tSYXRlKCkqIGJvb2xlYW5cbiAgICBzZXRQbGF5YmFja1JhdGUocmF0ZTogbnVtYmVyKSogdm9pZFxuICAgIGNhblNldFBsYXliYWNrUXVhbGl0eSgpKiBib29sZWFuXG4gICAgc2V0UGxheWJhY2tRdWFsaXR5KHF1YWxpdHk6IHN0cmluZykqIHZvaWRcbiAgICBjYW5TZXRGdWxsc2NyZWVuKCkqIGJvb2xlYW5cbiAgICBlbnRlckZ1bGxzY3JlZW4ob3B0aW9ucz86IEZ1bGxzY3JlZW5PcHRpb25zKSogUHJvbWlzZX52b2lkflxuICAgIGV4aXRGdWxsc2NyZWVuKCkqIFByb21pc2V-dm9pZH5cbiAgICBjYW5TZXRQaVAoKSogYm9vbGVhblxuICAgIGVudGVyUGlQKCkqIFByb21pc2V-dm9pZH5cbiAgICBleGl0UGlQKCkqIFByb21pc2V-dm9pZH5cbiAgICBzZXRDdXJyZW50VGV4dFRyYWNrKHRyYWNrSWQ6IG51bWJlcikqIHZvaWRcbiAgICBzZXRUZXh0VHJhY2tWaXNpYmlsaXR5KGlzVmlzaWJsZTogYm9vbGVhbikqIHZvaWRcbiAgICBnZXRNZWRpYVRyaW1taW5nKCkqIE1lZGlhVHJpbXx1bmRlZmluZWRcbiAgICBmZXRjaFJlY29tbWVuZGVkQXNwZWN0UmF0aW8oKSogUHJvbWlzZX5zdHJpbmd-XG4gICAgZmV0Y2hDdXJyZW50UG9zdGVyKCkqIFByb21pc2V-c3RyaW5nflxuICAgIGZldGNoQ3VycmVudE1lZGlhVGl0bGUoKSogUHJvbWlzZX5zdHJpbmd-XG4gICAgZmV0Y2hDdXJyZW50TWVkaWFEdXJhdGlvbigpKiBQcm9taXNlfm51bWJlcn5cbiAgICByZW5kZXJQbGF5ZXIoKSogSFRNTFRlbXBsYXRlU3RyaW5nXG4gICAgZGVzdHJveSgpKiB2b2lkXG4gICAgLXJlbmRlcigpIHZvaWRcbn1cblxuTWVkaWFQcm92aWRlciA8fC0tIE1lZGlhRmlsZVByb3ZpZGVyXG5NZWRpYVByb3ZpZGVyIDx8LS0gRW1iZWRlZE1lZGlhUHJvdmlkZXJcblxuY2xhc3MgTWVkaWFUeXBlIHtcbiAgICA8PGVudW1lcmF0aW9uPj5cbiAgICBBVURJT1xuICAgIFZJREVPXG59XG5cbmNsYXNzIFZpZXdUeXBlIHtcbiAgICA8PGVudW1lcmF0aW9uPj5cbiAgICBBVURJT1xuICAgIFZJREVPXG59XG5cbk1lZGlhVHlwZSAtLSBNZWRpYVByb3ZpZGVyXG5WaWV3VHlwZSAtLSBNZWRpYVByb3ZpZGVyXG5cbmNsYXNzIFBsYXllclxuXG5QbGF5ZXIgLS0gTWVkaWFUeXBlXG5QbGF5ZXIgLS0gVmlld1R5cGVcblBsYXllciBcIjFcIiAtLSogXCIwLi4qXCIgTWVkaWFQcm92aWRlcjogY29tcG9zaXRpb24iLCJtZXJtYWlkIjp7fSwidXBkYXRlRWRpdG9yIjpmYWxzZX0)

## Boot Strategy

**Default Strategy:** `LazyBootStrategy`

A boot [strategy](https://en.wikipedia.org/wiki/Strategy_pattern) controls when/how a player
is loaded the first time. The player implements the `Bootable` interface and registers
to the current boot strategy. The strategy will call the `boot()` method when it is ready to
load the player. The player will render whatever the `renderWhileBooting()` method returns
if it's available, otherwise it'll default to `<slot name="booting" />`.

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgLi4uXG4gICAgK2Jvb3RTdHJhdGVneTogY2xpY2sgfCBsYXp5IHwgaW1tZWRpYXRlIHwgQm9vdFN0cmF0ZWd5XG59XG5cbmNsYXNzIEJvb3RhYmxlIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgYm9vdFRhcmdldDogSFRNTEVsZW1lbnRcbiAgICBib290KCkgUHJvbWlzZX52b2lkflxufVxuXG5QbGF5ZXIgLS0-IEJvb3RhYmxlOiBpbXBsZW1lbnRzXG5cbmNsYXNzIEJvb3RTdHJhdGVneX5UIGV4dGVuZHMgQm9vdGFibGV-IHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgaGFzQm9vdGVkOiBib29sZWFuXG4gICAgcmVnaXN0ZXIoYm9vdGFibGU6IEJvb3RhYmxlKSBQcm9taXNlfnZvaWR-XG4gICAgcmVuZGVyV2hpbGVCb290aW5nKCkgVGVtcGxhdGVSZXN1bHRcbn1cblxuY2xhc3MgTGF6eUJvb3RTdHJhdGVneVxuY2xhc3MgQ2xpY2tCb290U3RyYXRlZ3lcbmNsYXNzIEltbWVkaWF0ZUJvb3RTdHJhdGVneVxuXG5Cb290U3RyYXRlZ3kgPC0tIExhenlCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gQ2xpY2tCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gSW1tZWRpYXRlQm9vdFN0cmF0ZWd5OiBpbXBsZW1lbnRzXG5Cb290U3RyYXRlZ3kgLS0-IEJvb3RhYmxlXG5cblBsYXllciAtLSBCb290U3RyYXRlZ3k6IHVzZSIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgLi4uXG4gICAgK2Jvb3RTdHJhdGVneTogY2xpY2sgfCBsYXp5IHwgaW1tZWRpYXRlIHwgQm9vdFN0cmF0ZWd5XG59XG5cbmNsYXNzIEJvb3RhYmxlIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgYm9vdFRhcmdldDogSFRNTEVsZW1lbnRcbiAgICBib290KCkgUHJvbWlzZX52b2lkflxufVxuXG5QbGF5ZXIgLS0-IEJvb3RhYmxlOiBpbXBsZW1lbnRzXG5cbmNsYXNzIEJvb3RTdHJhdGVneX5UIGV4dGVuZHMgQm9vdGFibGV-IHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgaGFzQm9vdGVkOiBib29sZWFuXG4gICAgcmVnaXN0ZXIoYm9vdGFibGU6IEJvb3RhYmxlKSBQcm9taXNlfnZvaWR-XG4gICAgcmVuZGVyV2hpbGVCb290aW5nKCkgVGVtcGxhdGVSZXN1bHRcbn1cblxuY2xhc3MgTGF6eUJvb3RTdHJhdGVneVxuY2xhc3MgQ2xpY2tCb290U3RyYXRlZ3lcbmNsYXNzIEltbWVkaWF0ZUJvb3RTdHJhdGVneVxuXG5Cb290U3RyYXRlZ3kgPC0tIExhenlCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gQ2xpY2tCb290U3RyYXRlZ3k6IGltcGxlbWVudHNcbkJvb3RTdHJhdGVneSA8LS0gSW1tZWRpYXRlQm9vdFN0cmF0ZWd5OiBpbXBsZW1lbnRzXG5Cb290U3RyYXRlZ3kgLS0-IEJvb3RhYmxlXG5cblBsYXllciAtLSBCb290U3RyYXRlZ3k6IHVzZSIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)

## Media Load Strategy

**Default Strategy:** `FirstCanPlayMediaLoadStrategy`

The media load [strategy](https://en.wikipedia.org/wiki/Strategy_pattern) controls which source/s
are loaded and by which loader (ie: provider). The player implements the `MediaController` interface
and registers to the current load strategy. The player will then call `onSrcChange(src)` on the
strategy when the `src` changes. The strategy is then responsible for a) determining the
correct loader to use and calling `setCurrentLoader` on the player, and b) calling `loadMedia(src)`
on the loader when it's ready.

The player will render whatever the `renderWhileLoading()` method returns if it's available,
otherwise it'll default to `<slot name="loading" />`.

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgLi4uXG4gICAgK21lZGlhTG9hZFN0cmF0ZWd5OiBmaXJzdENhblBsYXkgfCBNZWRpYUxvYWRTdHJhdGVneVxufVxuXG5jbGFzcyBNZWRpYUNvbnRyb2xsZXIge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBnZXRMb2FkZXJzKCkgTWVkaWFMb2FkZXJbXVxuICAgIHNldEN1cnJlbnRMb2FkZXIobG9hZGVyOiBNZWRpYUxvYWRlcikgdm9pZFxufVxuXG5NZWRpYUNvbnRyb2xsZXItLT4gTWVkaWFMb2FkZXJcblBsYXllciAtLT4gTWVkaWFDb250cm9sbGVyOiBpbXBsZW1lbnRzXG5cbmNsYXNzIE1lZGlhTG9hZGVyIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgSUQ6IHN0cmluZ1xuICAgIGNhblBsYXkoc3JjOiBTb3VyY2VbXSkgYm9vbGVhblxuICAgIGxvYWRNZWRpYShzcmM6IFNvdXJjZVtdKSBQcm9taXNlfnZvaWR-XG59XG5cbmNsYXNzIE1lZGlhTG9hZFN0cmF0ZWd5flQgZXh0ZW5kcyBNZWRpYUxvYWRlcn4ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICByZWdpc3Rlcihjb250cm9sbGVyOiBNZWRpYUNvbnRyb2xsZXIpIHZvaWRcbiAgICBvblNyY0NoYW5nZShzcmM6IFNvdXJjZVtdKSBQcm9taXNlfnZvaWR-XG4gICAgcmVuZGVyV2hpbGVMb2FkaW5nKCkgVGVtcGxhdGVSZXN1bHRcbn1cblxuY2xhc3MgRmlyc3RDYW5QbGF5TWVkaWFMb2FkU3RyYXRlZ3lcblxuTWVkaWFMb2FkU3RyYXRlZ3kgPC0tIEZpcnN0Q2FuUGxheU1lZGlhTG9hZFN0cmF0ZWd5OiBpbXBsZW1lbnRzXG5cblBsYXllciAtLSBNZWRpYUxvYWRTdHJhdGVneTogdXNlXG5QbGF5ZXIgXCIxXCIgLS0qIFwiMC4uKlwiIE1lZGlhUHJvdmlkZXI6IGNvbXBvc2l0aW9uXG5cbk1lZGlhUHJvdmlkZXIgLS0-IE1lZGlhTG9hZGVyOiBpbXBsZW1lbnRzIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllciB7XG4gICAgLi4uXG4gICAgK21lZGlhTG9hZFN0cmF0ZWd5OiBmaXJzdENhblBsYXkgfCBNZWRpYUxvYWRTdHJhdGVneVxufVxuXG5jbGFzcyBNZWRpYUNvbnRyb2xsZXIge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICBnZXRMb2FkZXJzKCkgTWVkaWFMb2FkZXJbXVxuICAgIHNldEN1cnJlbnRMb2FkZXIobG9hZGVyOiBNZWRpYUxvYWRlcikgdm9pZFxufVxuXG5NZWRpYUNvbnRyb2xsZXItLT4gTWVkaWFMb2FkZXJcblBsYXllciAtLT4gTWVkaWFDb250cm9sbGVyOiBpbXBsZW1lbnRzXG5cbmNsYXNzIE1lZGlhTG9hZGVyIHtcbiAgICA8PGludGVyZmFjZT4-XG4gICAgSUQ6IHN0cmluZ1xuICAgIGNhblBsYXkoc3JjOiBTb3VyY2VbXSkgYm9vbGVhblxuICAgIGxvYWRNZWRpYShzcmM6IFNvdXJjZVtdKSBQcm9taXNlfnZvaWR-XG59XG5cbmNsYXNzIE1lZGlhTG9hZFN0cmF0ZWd5flQgZXh0ZW5kcyBNZWRpYUxvYWRlcn4ge1xuICAgIDw8aW50ZXJmYWNlPj5cbiAgICByZWdpc3Rlcihjb250cm9sbGVyOiBNZWRpYUNvbnRyb2xsZXIpIHZvaWRcbiAgICBvblNyY0NoYW5nZShzcmM6IFNvdXJjZVtdKSBQcm9taXNlfnZvaWR-XG4gICAgcmVuZGVyV2hpbGVMb2FkaW5nKCkgVGVtcGxhdGVSZXN1bHRcbn1cblxuY2xhc3MgRmlyc3RDYW5QbGF5TWVkaWFMb2FkU3RyYXRlZ3lcblxuTWVkaWFMb2FkU3RyYXRlZ3kgPC0tIEZpcnN0Q2FuUGxheU1lZGlhTG9hZFN0cmF0ZWd5OiBpbXBsZW1lbnRzXG5cblBsYXllciAtLSBNZWRpYUxvYWRTdHJhdGVneTogdXNlXG5QbGF5ZXIgXCIxXCIgLS0qIFwiMC4uKlwiIE1lZGlhUHJvdmlkZXI6IGNvbXBvc2l0aW9uXG5cbk1lZGlhUHJvdmlkZXIgLS0-IE1lZGlhTG9hZGVyOiBpbXBsZW1lbnRzIiwibWVybWFpZCI6e30sInVwZGF0ZUVkaXRvciI6ZmFsc2V9)

## Player Sync

**WIP**

Video players operate in sync to a certain degree. Changes to one player's volume or muted state 
might propagate to a stored user preference or to the state of other players on the current page 
(and possibly subsequent pages). The playback position of a video might need to be maintained as the 
user transitions from a listing view to a detail view containing the same video. The play event of 
one video might trigger pause of any other actively playing video.

The player does not need to provide/include a manager, but it should be designed with one in mind: an 
ancestral component that can monitor events and access an imperative API of registered playback 
components. This may/may not require a registration phase upon connection. DOM traversal may not be 
sufficient means of discovery as players could be removed and returned from the DOM in certain UIs, 
such as an infinite scroll.

## Media Sync

**WIP**

## UI

The UI are a collection of components that are self contained and connect to the player via a
`Context`. The player is the provider who is responsible for updating the current
value, and UI components are consumers who simply listen for updates on when a value is changed.

> See the React documentation on [Context](https://reactjs.org/docs/context.html) as a primer if you
> haven't seen this pattern before.

[![](https://mermaid.ink/img/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllclN0YXRlXG5cbmNsYXNzIFBsYXllckNvbnRleHQge1xuICAgIDw8b2JqZWN0Pj5cbiAgICBwYXVzZWQ6IENvbnRleHQ8Ym9vbGVhbj5cbiAgICBjdXJyZW50VGltZTogQ29udGV4dDxudW1iZXI-XG4gICAgdm9sdW1lOiBDb250ZXh0PG51bWJlcj5cbiAgICAuLi5cbn1cblxuY2xhc3MgQ29udGV4dFByb3ZpZGVyIHtcbiAgICA8PGxpYnJhcnk-PlxufVxuXG5QbGF5ZXJDb250ZXh0IC0tPiBDb250ZXh0UHJvdmlkZXI6IHVzZXNcblBsYXllckNvbnRleHQgLS0-IFBsYXllclN0YXRlOiBpbXBsZW1lbnRzXG5cbmNsYXNzIFBsYXllclxuXG5QbGF5ZXIgLS0-IFBsYXllckNvbnRleHQ6IHByb3ZpZGVzXG5cbmNsYXNzIFVJQ29tcG9uZW50XG5cblVJQ29tcG9uZW50IC0tPiBQbGF5ZXJDb250ZXh0OiBjb25zdW1lcyIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)](https://mermaid-js.github.io/mermaid-live-editor/#/edit/eyJjb2RlIjoiY2xhc3NEaWFncmFtXG5cbmNsYXNzIFBsYXllclN0YXRlXG5cbmNsYXNzIFBsYXllckNvbnRleHQge1xuICAgIDw8b2JqZWN0Pj5cbiAgICBwYXVzZWQ6IENvbnRleHQ8Ym9vbGVhbj5cbiAgICBjdXJyZW50VGltZTogQ29udGV4dDxudW1iZXI-XG4gICAgdm9sdW1lOiBDb250ZXh0PG51bWJlcj5cbiAgICAuLi5cbn1cblxuY2xhc3MgQ29udGV4dFByb3ZpZGVyIHtcbiAgICA8PGxpYnJhcnk-PlxufVxuXG5QbGF5ZXJDb250ZXh0IC0tPiBDb250ZXh0UHJvdmlkZXI6IHVzZXNcblBsYXllckNvbnRleHQgLS0-IFBsYXllclN0YXRlOiBpbXBsZW1lbnRzXG5cbmNsYXNzIFBsYXllclxuXG5QbGF5ZXIgLS0-IFBsYXllckNvbnRleHQ6IHByb3ZpZGVzXG5cbmNsYXNzIFVJQ29tcG9uZW50XG5cblVJQ29tcG9uZW50IC0tPiBQbGF5ZXJDb250ZXh0OiBjb25zdW1lcyIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ)

```ts
import createContext, { Context } from '@wcom/context';
import { PlayerState } from './PlayerState';

export type PlayerContext = {
  [P in keyof PlayerState]: Context<PlayerState<P>>;
};

export const playerContext: PlayerContext = {
  paused: createContext(false),
  currentTime: createContext(0),
  volume: createContext(30),
  // ...
};
```

```ts
import { playerContext } from './playerContext';

class Player {
  // ...

  @playerContext.paused.provide();
  pausedCtx = playerContext.paused.defaultValue;

  // ...
}
```

```ts
import { playerContext } from './playerContext';

class UIComponent {
  // ...

  @playerContext.paused.consume();
  paused = playerContext.paused.defaultValue;

  // ...
}
```
